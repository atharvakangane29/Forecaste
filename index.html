<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Platfrom A</title>
    
    <link href="https://fonts.googleapis.com/css2?family=Inter:wght@300;400;600;700&family=JetBrains+Mono:wght@400;500&display=swap" rel="stylesheet">


    <link rel="stylesheet" href="https://unpkg.com/leaflet@1.9.4/dist/leaflet.css" crossorigin=""/>
    <script src="https://unpkg.com/leaflet@1.9.4/dist/leaflet.js" crossorigin=""></script>

    <script src="https://unpkg.com/flowbite@2.5.2/dist/flowbite.min.js"></script>
    <script src="https://cdn.tailwindcss.com"></script>
    <script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
    <script src="https://d3js.org/d3.v7.min.js"></script>
    <script src="https://cdn.jsdelivr.net/npm/d3-sankey@0.12.3/dist/d3-sankey.min.js"></script>
    <script src="https://unpkg.com/lucide@latest"></script>
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/noUiSlider/15.7.1/nouislider.min.css">
    <script src="https://cdnjs.cloudflare.com/ajax/libs/noUiSlider/15.7.1/nouislider.min.js"></script>
    <link rel="stylesheet" href="assets/css/styles.css">

    <script>
        tailwind.config = {
            theme: {
                extend: {
                    fontFamily: {
                        sans: ['Inter', 'sans-serif'],
                        mono: ['JetBrains Mono', 'monospace'],
                    },
                    colors: {
                        'palladian': '#EEE9DF',
                        'oatmeal': '#C9C1B1',
                        'blue-fantastic': '#2C3B4D',
                        'burning-flame': '#FFB162',
                        'truffle-trouble': '#A35139',
                        'abyssal': '#1B2632',
                        // Map functional roles to palette
                        'primary': '#2C3B4D', // Blue Fantastic
                        'accent': '#FFB162',  // Burning Flame
                        'danger': '#A35139',  // Truffle Trouble
                        'neutral': '#C9C1B1'  // Oatmeal
                    }
                }
            }
        }
    </script>
</head>
<body class="bg-slate-50 text-slate-800 antialiased h-screen overflow-hidden">

    <div id="view-intro" class="fixed inset-0 z-[60] bg-[var(--color-palladian)] flex flex-col items-center justify-center text-[var(--color-abyssal)] transition-opacity duration-500">
        <div class="max-w-4xl w-full p-8 text-center space-y-8">
            <div class="flex justify-center mb-6">
                <img src="assets/img/logo.png" alt="Logo" class="w-24 h-24 object-contain drop-shadow-xl">
            </div>
            
            <div id="intro-slides" class="relative min-h-[200px]">
                <div class="intro-slide animate-fade-in block">
                    <h1 class="text-5xl font-bold mb-4 tracking-tight">Predict. Plan. Perform.</h1>
                    <p class="text-xl text-[var(--color-blue-fantastic)] opacity-80">Forecasting for commercial planning.</p>
                </div>
                </div>

            <button onclick="AuthFlow.goToLogin()" class="mt-12 px-10 py-4 bg-[var(--color-blue-fantastic)] text-[var(--color-palladian)] text-lg font-bold rounded-full shadow-lg hover:bg-[var(--color-abyssal)] hover:scale-105 transition-all">
                Get Started
            </button>
        </div>
        
        <div class="absolute bottom-0 left-0 w-full h-2 bg-[var(--color-burning-flame)]"></div>
    </div>

    
    <div id="view-login" class="fixed inset-0 z-[60] bg-[var(--color-palladian)] hidden grid place-items-center">
    <!-- <div id="view-login" class="fixed inset-0 z-[60] bg-[var(--color-palladian)] grid place-items-center transition-opacity duration-400 ease-out opacity-0 pointer-events-none"> -->
        <div class="bg-white/80 backdrop-blur-md p-10 rounded-2xl shadow-2xl border border-[var(--color-oatmeal)] w-full max-w-md relative overflow-hidden">  
            <div class="text-center mb-8">
                <h2 class="text-3xl font-bold text-[var(--color-blue-fantastic)]">Welcome Back</h2>
                <p class="text-sm text-[var(--color-abyssal)] opacity-60 mt-2">Sign in to access your dashboard</p>
            </div>

            <div class="space-y-6">
                <div>
                    <label class="block text-xs font-bold uppercase text-[var(--color-abyssal)] mb-2">Username</label>
                    <input type="text" value="John Doe" class="w-full p-4 rounded-lg bg-[var(--color-palladian)] border border-[var(--color-oatmeal)] focus:ring-2 focus:ring-[var(--color-burning-flame)] outline-none text-[var(--color-abyssal)] font-medium">
                </div>
                <div>
                    <label class="block text-xs font-bold uppercase text-[var(--color-abyssal)] mb-2">Password</label>
                    <input type="password" value="***********" class="w-full p-4 rounded-lg bg-[var(--color-palladian)] border border-[var(--color-oatmeal)] focus:ring-2 focus:ring-[var(--color-burning-flame)] outline-none text-[var(--color-abyssal)]">
                </div>
                <button onclick="AuthFlow.handleLogin()" class="w-full py-4 bg-[var(--color-burning-flame)] text-[var(--color-abyssal)] font-bold rounded-lg shadow-md hover:brightness-110 transition-all flex items-center justify-center gap-2">
                    <span>Log In</span>
                    <i data-lucide="arrow-right" class="w-5"></i>
                </button>
            </div>

            <div class="mt-6 text-center">
                <a href="#" class="text-xs text-[var(--color-blue-fantastic)] font-bold hover:underline">Create an account</a>
            </div>
        </div>
    </div>

    <div id="view-wizard" class="fixed inset-0 z-50 bg-[var(--color-palladian)] hidden">
        <div class="h-16 border-b flex items-center justify-between px-8 bg-slate-50">
            <div class="flex items-center gap-3">
                <div class="w-8 h-8 bg-blue-600 rounded-lg flex items-center justify-center text-white"><i data-lucide="zap" class="w-5"></i></div>
                <span class="font-bold text-lg text-slate-700">Data Onboarding Wizard</span>
            </div>
            <div class="flex items-center gap-2">
                <div class="h-2 w-24 bg-slate-200 rounded-full overflow-hidden">
                    <div id="wizard-progress" class="h-full bg-blue-600 w-1/3 transition-all duration-500"></div>
                </div>
                <span class="text-xs font-bold text-slate-400 ml-2" id="wizard-step-text">Step 1 of 3</span>
            </div>
        </div>

        
            <!-- Insert this directly after the header bar (after the second </div> that closes the top bar) -->
        <!-- <div class="flex items-center justify-center gap-3 py-3 border-b bg-[var(--color-palladian)]"> -->
        <div class="flex items-center justify-center gap-3 py-3 border-b border-[var(--color-oatmeal)] bg-[var(--color-palladian)]">
            <!--  
            <img
                src="/assets/img/logo.png" 
                alt="Circulants logo"
                class="w-8 h-8 object-contain"
                loading="lazy"
            />
            -->
            <img src="assets/img/logo.png" alt="Logo" class="w-8 h-8 object-contain">
            <span class="text-slate-600 font-semibold tracking-wide">
                Circulants platform A
            </span>
        </div>


        <div class="flex-1 flex items-center justify-center p-6 bg-slate-50/50">
            <div class="max-w-3xl w-full">
                
                <div id="wizard-step-1" class="wizard-step active">
                    <h1 class="text-3xl font-bold text-slate-900 mb-2 text-center">How would you like to ingest data?</h1>
                    <button id="btn-dataset-info" class="text-slate-400 hover:text-blue-600 transition-colors" title="Dataset Information">
                            <i data-lucide="info" class="w-6 h-6"></i>
                    </button>
                    <p class="text-slate-500 text-center mb-10">Select a source to begin the pipeline configuration.</p>
                    <div class="grid grid-cols-1 md:grid-cols-2 gap-6">
                        <div class="bg-white p-8 rounded-2xl border border-slate-200 shadow-sm hover:border-purple-500 hover:shadow-xl hover:-translate-y-1 transition-all cursor-pointer group" onclick="Wizard.goToStep(2, 'cloud')">
                            <div class="w-14 h-14 bg-purple-50 text-purple-600 rounded-full flex items-center justify-center mb-6 group-hover:bg-purple-600 group-hover:text-white transition-colors">
                                <i data-lucide="cloud-cog" class="w-7"></i>
                            </div>
                            <h3 class="text-xl font-bold text-slate-800 mb-2">Cloud Warehouse</h3>
                            <p class="text-sm text-slate-500 mb-4">Connect to enterprise data lakes.</p>
                        </div>
                        <div class="bg-white p-8 rounded-2xl border border-slate-200 shadow-sm hover:border-blue-500 hover:shadow-xl hover:-translate-y-1 transition-all cursor-pointer group" onclick="Wizard.goToStep(2, 'file')">
                            <div class="w-14 h-14 bg-blue-50 text-blue-600 rounded-full flex items-center justify-center mb-6 group-hover:bg-blue-600 group-hover:text-white transition-colors">
                                <i data-lucide="file-up" class="w-7"></i>
                            </div>
                            <h3 class="text-xl font-bold text-slate-800 mb-2">File Upload</h3>
                            <p class="text-sm text-slate-500 mb-4">Upload local datasets directly.</p>
                        </div>
                    </div>
                </div>

                <div id="wizard-step-file" class="wizard-step">
                    <button class="text-sm text-slate-400 hover:text-slate-800 mb-6 flex items-center gap-1" onclick="Wizard.goToStep(1)"><i data-lucide="arrow-left" class="w-4"></i> Back</button>
                    <div class="bg-white rounded-2xl border-2 border-dashed border-slate-300 p-16 text-center transition-all" id="wizard-dropzone">
                        <div class="w-20 h-20 bg-slate-50 text-slate-400 rounded-full flex items-center justify-center mx-auto mb-6">
                            <i data-lucide="upload-cloud" class="w-10"></i>
                        </div>
                        <h3 class="text-xl font-bold text-slate-800">Drag & Drop files here</h3>
                        <p class="text-slate-500 mt-2">or <span class="text-blue-600 font-bold cursor-pointer hover:underline" onclick="Wizard.handleFileBrowse()">browse computer</span></p>
                    </div>
                </div>

                <div id="wizard-step-cloud" class="wizard-step">
                    <button class="text-sm text-slate-400 hover:text-slate-800 mb-6 flex items-center gap-1" onclick="Wizard.goToStep(1)"><i data-lucide="arrow-left" class="w-4"></i> Back</button>
                    <div class="bg-white rounded-2xl border border-slate-200 shadow-sm p-8">
                        <div id="cloud-form" class="space-y-4">
                            <h2 class="text-xl font-bold mb-6 flex items-center gap-2"><i data-lucide="lock" class="w-5 text-purple-500"></i> Secure Connection</h2>
                            
                            <div>
                                <label class="block text-xs font-bold text-slate-500 uppercase mb-1">Provider</label>
                                <select class="w-full p-3 border rounded-lg bg-slate-50 focus:ring-2 focus:ring-purple-500 outline-none text-sm">
                                    <option>Databricks Lakehouse</option>
                                    <option>Snowflake Data Cloud</option>
                                    <option>Google BigQuery</option>
                                </select>
                            </div>
                            <div>
                                <label class="block text-xs font-bold text-slate-500 uppercase mb-1">Host URL / Account ID</label>
                                <input type="text" value="dbc-xxxx-xxxx.cloud.databricks.com" class="w-full p-3 border rounded-lg focus:ring-2 focus:ring-purple-500 outline-none text-sm font-mono text-slate-600">
                            </div>
                            <div>
                                <label class="block text-xs font-bold text-slate-500 uppercase mb-1">Personal Access Token</label>
                                <input type="password" value="dapi123456789" class="w-full p-3 border rounded-lg focus:ring-2 focus:ring-purple-500 outline-none text-sm font-mono text-slate-600">
                            </div>

                            <button onclick="Wizard.simulateConnection()" class="w-full bg-purple-600 hover:bg-purple-700 text-white font-bold py-3 rounded-lg mt-4 flex justify-center items-center gap-2 transition-colors">
                                Authenticate & Scan <i data-lucide="arrow-right" class="w-4"></i>
                            </button>
                        </div>
                        
                        <div id="cloud-selection" class="hidden space-y-4 animate-fade-in">
                            <div class="flex items-center gap-2 text-emerald-600 bg-emerald-50 p-3 rounded-lg mb-4 border border-emerald-100">
                                <i data-lucide="check-circle-2" class="w-5"></i>
                                <span class="text-sm font-bold">Connection Established</span>
                            </div>
                            <button onclick="Wizard.finishWizard()" class="w-full bg-slate-900 hover:bg-slate-800 text-white font-bold py-3 rounded-lg mt-4 transition-colors">
                                Import Selected Data
                            </button>
                        </div>
                    </div>
                </div>

            </div>
        </div>
    </div>

    <div id="app-shell" class="hidden h-full opacity-0 bg-[var(--color-palladian)]. transition-opacity duration-700">
        
        <aside class="w-20 lg:w-64 bg-slate-900 text-white flex flex-col justify-between transition-all duration-300 z-20">
            <div>     <!--Sidebar-->
                <div class="h-16 flex items-center justify-center lg:justify-start lg:px-6 border-b border-slate-700 cursor-pointer" onclick="App.showToast('Home Refresh')">
                    <!-- <i data-lucide="activity" class="text-medical-500 w-8 h-8"></i> -->
                     <!-- <img src="C:\Users\AtharvaKangane\CIRCULANTS\Forcasting app\Frontend\assets\img\logo.png" alt="Logo" class="w-8 h-8" />  + object-contain-->
                     <img src="assets/img/logo.png" alt="Logo" class="w-8 h-8">
                    <span class="ml-3 font-bold text-lg hidden lg:block tracking-tight">Platfrom A</span>
                </div>
                <nav class="mt-8 space-y-2 px-2">
                    <a href="#" class="flex items-center p-3 text-slate-300 hover:bg-slate-800 rounded-lg group transition-colors" data-view="pipeline">
                        <i data-lucide="database" class="w-5 h-5 group-hover:text-white"></i>
                        <span class="ml-3 font-medium hidden lg:block">Data Pipeline</span>
                    </a>
                    <a href="#" class="flex items-center p-3 text-slate-300 hover:bg-slate-800 rounded-lg group transition-colors active-nav" data-view="dashboard">
                        <i data-lucide="layout-dashboard" class="w-5 h-5 group-hover:text-white"></i>
                        <span class="ml-3 font-medium hidden lg:block">Clinical Dashboard</span>
                    </a>

                    <a href="#" class="flex items-center p-3 text-slate-300 hover:bg-slate-800 rounded-lg group transition-colors active-nav" data-view="cancer-dashboard">
                        <i data-lucide="hospital" class="w-5 h-5 group-hover:text-white"></i>
                        <span class="ml-3 font-medium hidden lg:block">Cancer Dashboard</span>
                    </a>

                    <a href="#" class="flex items-center p-3 text-slate-300 hover:bg-slate-800 rounded-lg group transition-colors active-nav" data-view="geography-dashboard">
                        <i data-lucide="map" class="w-5 h-5 group-hover:text-white"></i>
                        <span class="ml-3 font-medium hidden lg:block">Geography Dashboard</span>
                    </a>
                    
                    <a href="#" class="flex items-center p-3 text-slate-300 hover:bg-slate-800 rounded-lg group transition-colors" data-view="scenario-builder">
                        <i data-lucide="layers" class="w-5 h-5 group-hover:text-white"></i>
                        <span class="ml-3 font-medium hidden lg:block">Scenario Builder</span>
                    </a>

                    <a href="#" class="flex items-center p-3 text-slate-300 hover:bg-slate-800 rounded-lg group transition-colors" data-view="forecasting">
                        <i data-lucide="trending-up" class="w-5 h-5 group-hover:text-white"></i>
                        <span class="ml-3 font-medium hidden lg:block">Forecasting</span>
                    </a>

                    <a href="#" class="flex items-center p-3 text-slate-300 hover:bg-slate-800 rounded-lg group transition-colors" data-view="scenario-comparison">
                        <i data-lucide="copy" class="w-5 h-5 group-hover:text-white"></i>
                        <span class="ml-3 font-medium hidden lg:block">Scenario Comparison</span>
                    </a>

                    <a href="#" class="flex items-center p-3 text-slate-300 hover:bg-slate-800 rounded-lg group transition-colors" data-view="Export-&-Reports">
                        <i data-lucide="file-down" class="w-5 h-5 group-hover:text-white"></i>
                        <span class="ml-3 font-medium hidden lg:block">Export & Reports</span>
                    </a>

                </nav>

            </div>
            <div class="p-4 border-t border-slate-700 cursor-pointer hover:bg-slate-800 transition-colors" onclick="App.handleLogout()">
                <div class="flex items-center gap-3">
                    <div class="w-8 h-8 rounded-full bg-gradient-to-tr from-blue-400 to-purple-500 flex items-center justify-center font-bold text-xs relative">
                        JD <span class="absolute bottom-0 right-0 w-2.5 h-2.5 bg-emerald-500 border-2 border-slate-900 rounded-full"></span>
                    </div>
                    <div class="hidden lg:block">
                        <p class="text-sm font-medium">John Doe</p>
                        <p class="text-xs text-slate-400">Oncology Admin</p>
                    </div>
                </div>
            </div>
        </aside>

        <main class="flex-1 flex flex-col h-full overflow-hidden relative">
            <header class="h-16 bg-white border-b flex items-center justify-between px-8 z-10">
                <h2 id="page-title" class="text-xl font-bold text-slate-800">Clinical Command Center</h2>
                <div class="flex items-center gap-4">
                    <button class="p-2 text-slate-400 hover:bg-slate-100 rounded-full"><i data-lucide="bell" class="w-5 h-5"></i></button>
                    <button class="p-2 text-slate-400 hover:bg-slate-100 rounded-full"><i data-lucide="settings" class="w-5 h-5"></i></button>
                </div>
            </header>

            <!-- <div class="flex-1 overflow-y-auto p-6 lg:p-10 relative scroll-smooth bg-[var(--color-palladian)]"> -->
            <div id="main-scroll-container" class="flex-1 overflow-y-auto p-6 lg:p-10 relative scroll-smooth bg-[var(--color-palladian)]">
                
                <div id="view-dashboard" class="space-y-6 max-w-7xl mx-auto animate-fade-in">
                    <div class="flex flex-col md:flex-row md:items-end gap-6 w-full mb-6"> 
                </div>
                    

                    <div id="dashboard-kpi-container" class="grid grid-cols-1 md:grid-cols-2 lg:grid-cols-4 gap-4">
                        <!-- <div class="bg-white p-6 rounded-xl border border-slate-100 shadow-sm">
                            <div class="flex justify-between items-start mb-4">
                                <div class="p-2 bg-blue-50 text-blue-600 rounded-lg"><i data-lucide="users" class="w-5 h-5"></i></div>
                                <span class="text-xs font-bold text-emerald-600 bg-emerald-50 px-2 py-1 rounded">+12.5%</span>
                            </div>
                            <h4 class="text-slate-500 text-xs font-bold uppercase tracking-wide">NDCC Patients</h4>
                            <p class="text-3xl font-bold text-slate-800 mt-2">1,284</p>
                        </div>

                        <div class="bg-white p-6 rounded-xl border border-slate-100 shadow-sm">
                            <div class="flex justify-between items-start mb-4">
                                <div class="p-2 bg-purple-50 text-purple-600 rounded-lg"><i data-lucide="timer" class="w-5 h-5"></i></div>
                                <span class="text-xs font-bold text-emerald-600 bg-emerald-50 px-2 py-1 rounded">-2.1 Days</span>
                            </div>
                            <h4 class="text-slate-500 text-xs font-bold uppercase tracking-wide">Avg TTI (Days)</h4>
                            <p class="text-3xl font-bold text-slate-800 mt-2">14.2</p>
                        </div>

                        <div class="bg-white p-6 rounded-xl border border-slate-100 shadow-sm">
                            <div class="flex justify-between items-start mb-4">
                                <div class="p-2 bg-orange-50 text-orange-600 rounded-lg"><i data-lucide="armchair" class="w-5 h-5"></i></div>
                                <span class="text-xs font-bold text-orange-600 bg-orange-50 px-2 py-1 rounded">High Load</span>
                            </div>
                            <h4 class="text-slate-500 text-xs font-bold uppercase tracking-wide">Infusion Chair Util</h4>
                            <p class="text-3xl font-bold text-slate-800 mt-2">88%</p>
                        </div>

                        <div class="bg-white p-6 rounded-xl border border-slate-100 shadow-sm">
                            <div class="flex justify-between items-start mb-4">
                                <div class="p-2 bg-emerald-50 text-emerald-600 rounded-lg"><i data-lucide="funnel" class="w-5 h-5"></i></div>
                                <span class="text-xs font-bold text-emerald-600 bg-emerald-50 px-2 py-1 rounded">+4%</span>
                            </div>
                            <h4 class="text-slate-500 text-xs font-bold uppercase tracking-wide">Gross Conversion Rate</h4>
                            <p class="text-3xl font-bold text-slate-800 mt-2">22.4%</p>
                        </div> -->
                    </div>

                    <!-- Top Insights -->
                    <div class="bg-white rounded-xl shadow-sm p-6">
                        <h3 class="text-lg font-semibold text-slate-800 mb-4">
                            Top Insights
                        </h3>
                        <ul id="dashboard-insights-container" class="space-y-3">
                        </ul>
                    </div>

                    <div class="grid grid-cols-1 lg:grid-cols-3 gap-6">
                        <div class="lg:col-span-2 bg-white p-6 rounded-xl border border-slate-100 shadow-sm">
                            <div class="flex gap-2 shrink-0">
                                <button class="px-4 py-2 text-xs font-bold rounded bg-blue-100 text-blue-700 filter-btn" data-period="7">7 Days</button>
                            </div>

                            <div class="flex-1 w-full pb-2 px-2">
                                <div class="flex justify-between text-[10px] font-bold text-slate-400 uppercase tracking-wider mb-3">
                                    <span id="slider-date-start">Jan 1, 2024</span>
                                    <span id="slider-date-end">Dec 31, 2024</span>
                                </div>
                                <div id="date-slider"></div>
                            </div>
                            <h3 class="font-bold text-slate-800 mb-6">Patient Volume Trends</h3>
                            <div class="h-72">
                                <canvas id="mainChart"></canvas>
                            </div>
                        </div>
                        <div class="bg-white p-6 rounded-xl border border-slate-100 shadow-sm">
                            <h3 class="font-bold text-slate-800 mb-6">Program Mix</h3>
                            <div class="h-64 relative flex items-center justify-center">
                                <canvas id="donutChart"></canvas>
                                <div class="absolute inset-0 flex items-center justify-center pointer-events-none">
                                    <div class="text-center mt-2">
                                        <!-- <span class="block text-3xl font-bold text-slate-800">1.2K</span> -->
                                        <span id="program-mix-total" class="block text-3xl font-bold text-slate-800">--</span>
                                        <span class="text-[10px] text-slate-400 uppercase tracking-widest">Total Pts</span>
                                    </div>
                                </div>
                            </div>
                            <div id="program-mix-legend" class="mt-4 space-y-2 px-4">
                                <!-- <div class="flex justify-between text-xs items-center"><span class="flex items-center gap-2"><span class="w-2 h-2 rounded-full bg-blue-600"></span> MedOnc</span> <span class="font-bold">55%</span></div>
                                <div class="flex justify-between text-xs items-center"><span class="flex items-center gap-2"><span class="w-2 h-2 rounded-full bg-purple-600"></span> SurgOnc</span> <span class="font-bold">25%</span></div>
                                <div class="flex justify-between text-xs items-center"><span class="flex items-center gap-2"><span class="w-2 h-2 rounded-full bg-cyan-500"></span> RadOnc</span> <span class="font-bold">20%</span></div> -->
                            </div>
                        </div>
                    </div>

                    <!--  KPI ROWS          
                    <div class="grid grid-cols-1 md:grid-cols-3 gap-6">
                        <div class="bg-white rounded-xl shadow-sm p-6">
                            <p class="text-sm text-slate-500">Avg Bed Utilization</p>
                            <h3 class="text-3xl font-bold text-slate-800 mt-2">78%</h3>
                        </div>
                        <div class="bg-white rounded-xl shadow-sm p-6">
                            <p class="text-sm text-slate-500">Infusion Chair Utilization</p>
                            <h3 class="text-3xl font-bold text-slate-800 mt-2">65%</h3>
                        </div>
                        <div class="bg-white rounded-xl shadow-sm p-6">
                            <p class="text-sm text-slate-500">Monthly Patient Volume</p>
                            <h3 class="text-3xl font-bold text-slate-800 mt-2">1,420</h3>
                        </div>
                    </div>
                    -->

                    <!-- Charts Row -->
                    <div class="grid grid-cols-1 lg:grid-cols-2 gap-6">
                        
                        <!-- Capacity Utilization -->
                        <div class="bg-white rounded-xl shadow-sm p-12" style="height: 400px">
                            <h3 class="text-lg font-semibold text-slate-800 mb-4">
                                Capacity Utilization (Monthly)
                            </h3>
                            <canvas id="capacityChart" ></canvas>
                        </div>

                        <!-- Program Performance -->
                        <div class="bg-white rounded-xl shadow-sm p-12" style="height: 400px">
                            <h3 class="text-lg font-semibold text-slate-800 mb-4">
                                Program Performance By Service Line
                            </h3>
                            <canvas id="programChart"></canvas>
                        </div>
                    </div>
                    
                    <div class="flex justify-end pt-8 pb-4">
                        <button onclick="App.switchView('cancer-dashboard')" class="group flex items-center gap-2 text-sm font-semibold text-slate-400 hover:text-blue-600 transition-colors">
                            Next: Cancer Dashboard <i data-lucide="arrow-right" class="w-4 h-4 group-hover:translate-x-1 transition-transform"></i>
                        </button>
                    </div>
                </div>
                
                <div id="view-cancer-dashboard" class="hidden space-y-6 max-w-7xl mx-auto animate-fade-in">
                    <div class="flex items-center justify-between mb-4">
                        <h2 class="text-2xl font-bold text-slate-800">Cancer Care Analytics</h2>
                        <!-- <span class="text-sm text-slate-500">Real-time oncology department metrics</span> -->
                    </div>

                    <div id="cancer-kpi-container" class="grid grid-cols-1 md:grid-cols-3 gap-6">
                        </div>

                    <div class="bg-white p-6 rounded-xl border border-slate-200 shadow-sm">
                        <h3 class="font-bold text-slate-800 mb-4">Patient Journey Flow</h3>
                        <div id="diagram-container" class="w-full min-h-[600px] bg-slate-50 border border-slate-200 rounded-lg p-4 relative">
                            <svg id="sankey-svg" class="w-full h-full block mx-auto"></svg>
                            
                            <div class="mt-6 p-4 bg-white/50 backdrop-blur-sm border border-slate-200 rounded-lg">
                                <h4 class="text-xs font-bold text-slate-500 uppercase mb-3">Journey Stages</h4>
                                <div class="grid grid-cols-2 md:grid-cols-4 gap-4">
                                    <div class="flex items-center gap-2">
                                        <div class="w-3 h-3 rounded bg-[#C9C1B1]"></div>
                                    <span class=" text-xs text-slate-600">Pre-Diagnosis</span>
                                    </div>
                                    <div class="flex items-center gap-2">
                                        <div class="w-3 h-3 rounded bg-[#A35139]"></div>
                                        <span class="text-xs text-slate-600">Initial Diagnosis & Treatment</span>
                                    </div>
                                    <div class="flex items-center gap-2">
                                        <div class="w-3 h-3 rounded bg-[#FFB162]"></div>
                                        <span class="text-xs text-slate-600">Subsiquent Refferal</span>
                                    </div>
                                    <div class="flex items-center gap-2">
                                        <div class="w-3 h-3 rounded bg-[#1B2632]"></div>
                                        <span class=" text-xs text-slate-600">Long-term Monitoring</span>
                                    </div>
                                </div>
                            </div>
                        </div>
                    </div>

                    <div class="grid grid-cols-1 lg:grid-cols-2 gap-6">
                        <div class="bg-white p-6 rounded-xl border border-slate-200 shadow-sm">
                            <h3 class="font-bold text-slate-800 mb-4">Cancer Type Distribution</h3>
                            <div class="h-64 relative w-full">
                                <canvas id="cancerTypeChart"></canvas>
                            </div>
                        </div>

                        <div class="bg-white p-6 rounded-xl border border-slate-200 shadow-sm">
                            <h3 class="font-bold text-slate-800 mb-4">Disease Site Grouping</h3>
                            <div class="h-64 relative w-full">
                                <canvas id="diseaseSiteChart"></canvas>
                            </div>
                        </div>

                        <div class="lg:col-span-2 bg-white p-6 rounded-xl border border-slate-200 shadow-sm">
                            <h3 class="font-bold text-slate-800 mb-4">Infusion Trends Over Time</h3>
                            <div class="h-72 relative w-full">
                                <canvas id="infusionTrendChart"></canvas>
                            </div>
                        </div>
                    </div>
                    <div class="flex justify-end pt-8 pb-4">
                        <button onclick="App.switchView('scenario-builder')" class="group flex items-center gap-2 text-sm font-semibold text-slate-400 hover:text-blue-600 transition-colors">
                            Next: Scenario Builder <i data-lucide="arrow-right" class="w-4 h-4 group-hover:translate-x-1 transition-transform"></i>
                        </button>
                    </div>
                </div>

                <div id="view-geography-dashboard" class="hidden space-y-8 max-w-7xl mx-auto animate-fade-in pb-10">
    
                    <div class="flex items-center justify-between">
                        <div>
                            <h2 class="text-2xl font-bold text-slate-800">Healthcare Market Intelligence</h2>
                            <!-- <span class="text-sm text-slate-500">Geographic Analysis & Payer Mix Strategy</span> -->
                        </div>
                        </div>

                    <div class="grid grid-cols-1 lg:grid-cols-3 gap-6">
                        <!-- <div class="lg:col-span-2 bg-white p-1 rounded-xl border border-slate-200 shadow-sm relative overflow-hidden group">
                            <div class="absolute top-4 right-4 z-10 flex flex-col gap-2">
                                <button class="p-2 bg-white shadow-md rounded-lg text-slate-600 hover:text-blue-600"><i data-lucide="plus" class="w-4 h-4"></i></button>
                                <button class="p-2 bg-white shadow-md rounded-lg text-slate-600 hover:text-blue-600"><i data-lucide="minus" class="w-4 h-4"></i></button>
                            </div>
                            <div class="lg:col-span-2 bg-white p-1 rounded-xl border border-slate-200 shadow-sm relative overflow-hidden group z-0">
                                <div class="h-[450px] w-full bg-slate-50 rounded-lg relative z-0" id="geoMap">
                                </div>
                            </div>
                        </div> -->

                        <!-- MODIFY - Remove nested duplicate div, keep only: -->
                        <div class="lg:col-span-2 bg-white p-1 rounded-xl border border-slate-200 shadow-sm relative overflow-hidden group">
                            <div class="absolute top-4 right-4 z-10 flex flex-col gap-2">
                                <button class="p-2 bg-white shadow-md rounded-lg text-slate-600 hover:text-blue-600">
                                    <i data-lucide="plus" class="w-4 h-4"></i>
                                </button>
                                <button class="p-2 bg-white shadow-md rounded-lg text-slate-600 hover:text-blue-600">
                                    <i data-lucide="minus" class="w-4 h-4"></i>
                                </button>
                            </div>
                            <div id="geoMap" class="h-[500px] w-full rounded-lg"></div>
                        </div>

                        <div class="space-y-4">
                            <div class="bg-orange-50 border border-orange-200 p-5 rounded-xl shadow-sm relative overflow-hidden">
                                <div class="absolute top-0 right-0 w-16 h-16 bg-orange-400 opacity-10 rounded-bl-full"></div>
                                <h4 class="text-xs font-bold text-orange-800 uppercase tracking-wider mb-2 flex items-center gap-2">
                                    <i data-lucide="alert-triangle" class="w-4 h-4"></i> Strategic Insight
                                </h4>
                                <p class="text-sm text-slate-800 leading-relaxed" id="geo-insight-text">Loading...</p>
                            </div>

                            <div class="bg-white p-6 rounded-xl border border-slate-200 shadow-sm h-full max-h-[320px] flex flex-col">
                                <h3 class="font-bold text-slate-800 mb-6 text-sm flex-shrink-0">Patient Distance Distribution</h3>
                                <div class="space-y-5 overflow-y-auto pr-2" id="geo-dist-list">
                                    </div>
                            </div>
                        </div>
                    </div>

                    <div>
                        <h3 class="font-bold text-slate-800 mb-4 text-lg">Payer Mix Analysis</h3>
                        <div class="grid grid-cols-1 md:grid-cols-3 gap-6" id="payer-mix-container">
                            </div>
                    </div>

                    <div class="grid grid-cols-1 lg:grid-cols-2 gap-6">
                        
                        <div class="bg-white p-6 rounded-xl border border-slate-200 shadow-sm">
                            <h3 class="font-bold text-slate-800 mb-6 text-sm">Payer Mix by Distance Band</h3>
                            <div class="h-64">
                                <canvas id="geoCrossChart"></canvas>
                            </div>
                        </div>

                        <div class="bg-white p-0 rounded-xl border border-slate-200 shadow-sm overflow-hidden">
                            <div class="px-6 py-4 border-b border-slate-100 bg-slate-50/50">
                                <h3 class="font-bold text-slate-800 text-sm">Top Counties by Volume</h3>
                            </div>
                            <table class="w-full text-sm text-left">
                                <thead class="text-xs text-slate-400 uppercase bg-slate-50 border-b border-slate-100">
                                    <tr>
                                        <th class="px-6 py-3 font-semibold">County</th>
                                        <th class="px-6 py-3 font-semibold text-right">Volume</th>
                                        <th class="px-6 py-3 font-semibold">Primary Payer</th>
                                        </tr>
                                </thead>
                                <tbody class="divide-y divide-slate-100" id="geo-county-body">
                                    </tbody>
                            </table>
                        </div>
                    </div>
                </div>

                <div id="view-pipeline" class="hidden space-y-8 max-w-7xl mx-auto">
                    
                    <div id="pipeline-kpi-container" class="grid grid-cols-1 md:grid-cols-3 gap-6">
                        <!-- <div class="bg-white p-6 rounded-xl border border-slate-200 shadow-sm flex items-center justify-between">
                            <div>
                                <p class="text-xs font-bold text-slate-400 uppercase tracking-wider">Completeness</p>
                                <h3 class="text-3xl font-bold text-slate-800 mt-1">94.2%</h3>
                            </div>
                            <span class="bg-emerald-50 text-emerald-600 text-xs font-bold px-2 py-1 rounded border border-emerald-100">+1.2%</span>
                        </div>
                        <div class="bg-white p-6 rounded-xl border border-slate-200 shadow-sm flex items-center justify-between">
                            <div>
                                <p class="text-xs font-bold text-slate-400 uppercase tracking-wider">Accuracy</p>
                                <h3 class="text-3xl font-bold text-slate-800 mt-1">97.8%</h3>
                            </div>
                            <span class="bg-emerald-50 text-emerald-600 text-xs font-bold px-2 py-1 rounded border border-emerald-100">+0.5%</span>
                        </div>
                        <div class="bg-white p-6 rounded-xl border border-slate-200 shadow-sm flex items-center justify-between">
                            <div>
                                <p class="text-xs font-bold text-slate-400 uppercase tracking-wider">Timeliness</p>
                                <h3 class="text-3xl font-bold text-slate-800 mt-1">98.5%</h3>
                            </div>
                            <span class="bg-red-50 text-red-500 text-xs font-bold px-2 py-1 rounded border border-red-100">-0.3%</span>
                        </div> -->
                    </div>

                    <div class="grid grid-cols-1 lg:grid-cols-3 gap-8">
                        <div class="lg:col-span-2 bg-white rounded-xl border border-slate-200 shadow-sm overflow-hidden">
                            <div class="px-6 py-4 border-b border-slate-100 flex justify-between items-center bg-white">
                                <h3 class="font-bold text-slate-800 text-sm">Active Data Sources</h3>
                                <button class="text-xs text-blue-600 font-bold hover:underline">Refresh</button>
                            </div>
                            <div class="overflow-x-auto">
                                <table class="w-full text-sm text-left">
                                    <thead class="text-xs text-slate-400 uppercase bg-slate-50 border-b border-slate-100">
                                        <tr>
                                            <th class="px-6 py-3 font-semibold">Source System</th>
                                            <th class="px-6 py-3 font-semibold">Data Type</th>
                                            <th class="px-6 py-3 font-semibold">Load Type</th>
                                            <th class="px-6 py-3 font-semibold">Status</th>
                                            <th class="px-6 py-3 font-semibold">Last Sync</th>
                                            <th class="px-6 py-3 font-semibold text-right">Records</th>
                                        </tr>
                                    </thead>
                                    <tbody id="pipeline-sources-body" class="divide-y divide-slate-100">
                                        <!-- <tr class="hover:bg-slate-50">
                                            <td class="px-6 py-4 font-medium text-slate-900">Hospital EMR</td>
                                            <td class="px-6 py-4 text-slate-500">Inpatient/Outpatient</td>
                                            <td class="px-6 py-4"><span class="bg-emerald-100 text-emerald-700 px-2 py-0.5 rounded text-[10px] font-bold uppercase tracking-wide">Active</span></td>
                                            <td class="px-6 py-4 text-slate-500">2024-02-22</td>
                                            <td class="px-6 py-4 text-right font-mono">2.4M</td>
                                        </tr>
                                        <tr class="hover:bg-slate-50">
                                            <td class="px-6 py-4 font-medium text-slate-900">Cancer Registry</td>
                                            <td class="px-6 py-4 text-slate-500">Diagnosis/Stage</td>
                                            <td class="px-6 py-4"><span class="bg-emerald-100 text-emerald-700 px-2 py-0.5 rounded text-[10px] font-bold uppercase tracking-wide">Active</span></td>
                                            <td class="px-6 py-4 text-slate-500">2024-02-22</td>
                                            <td class="px-6 py-4 text-right font-mono">856K</td>
                                        </tr>
                                        <tr class="hover:bg-slate-50">
                                            <td class="px-6 py-4 font-medium text-slate-900">Referral System</td>
                                            <td class="px-6 py-4 text-slate-500">Physician Referrals</td>
                                            <td class="px-6 py-4"><span class="bg-emerald-100 text-emerald-700 px-2 py-0.5 rounded text-[10px] font-bold uppercase tracking-wide">Active</span></td>
                                            <td class="px-6 py-4 text-slate-500">2024-02-22</td>
                                            <td class="px-6 py-4 text-right font-mono">423K</td>
                                        </tr> -->
                                    </tbody>
                                </table>
                            </div>
                        </div>

                        <div class="bg-white p-6 rounded-xl border border-slate-200 shadow-sm">
                            <h3 class="font-bold text-slate-800 mb-4 text-sm">Data Completeness Trend</h3>
                            <div class="h-64">
                                <canvas id="ingestionChart"></canvas>
                            </div>
                        </div>
                    </div>

                    
                    <div id="schema-container" class="bg-[#0f172a] rounded-xl overflow-hidden shadow-2xl relative h-[450px]">
                    <div class="absolute top-4 left-4 z-10 bg-slate-800/80 backdrop-blur px-3 py-1 rounded border border-slate-700 text-xs font-bold text-slate-400">
                        SCHEMA BUILDER (DRAG NODES)
                    </div>

                    <!-- SVG lines layer -->
                    <svg id="schema-lines" class="absolute inset-0 w-full h-full pointer-events-none"  width="100%" height="100%"
                    style="position:absolute; inset:0; pointer-events:none; z-index:0"></svg>

                    <!-- SOURCES -->
                    <div id="source-emr" class="schema-node bg-white p-4 rounded shadow-lg w-40 text-center top-24 left-24" data-role="source">
                        <div class="text-[10px] text-slate-400 font-bold uppercase mb-1">Source</div>
                        <div class="font-bold text-sm flex items-center justify-center gap-2"><i data-lucide="database" class="w-4"></i> Hospital EMR</div>
                    </div>

                    <div id="source-registry" class="schema-node bg-white p-4 rounded shadow-lg w-40 text-center top-44 left-24" data-role="source">
                        <div class="text-[10px] text-slate-400 font-bold uppercase mb-1">Source</div>
                        <div class="font-bold text-sm flex items-center justify-center gap-2"><i data-lucide="database" class="w-4"></i> Cancer Registry</div>
                    </div>

                    <div id="source-referrals" class="schema-node bg-white p-4 rounded shadow-lg w-40 text-center top-64 left-24" data-role="source">
                        <div class="text-[10px] text-slate-400 font-bold uppercase mb-1">Source</div>
                        <div class="font-bold text-sm flex items-center justify-center gap-2"><i data-lucide="database" class="w-4"></i> Referral System</div>
                    </div>

                    <!-- PROCESS (node-2) -->
                    <div id="process" class="schema-node bg-blue-600 text-white p-5 rounded-lg shadow-xl w-48 text-center top-40 left-[40%]" data-role="process">
                        <div class="text-[10px] text-blue-200 font-bold uppercase mb-1">Process</div>
                        <div class="font-bold text-sm flex items-center justify-center gap-2"><i data-lucide="cpu" class="w-4"></i> Spark Cleaner</div>
                    </div>

                    <!-- TABLES -->
                    <div id="table-fact-patients" class="schema-node bg-white p-4 rounded shadow-lg w-40 text-center top-24 right-32" data-role="table">
                        <div class="text-[10px] text-slate-400 font-bold uppercase mb-1">Table</div>
                        <div class="font-bold text-sm flex items-center justify-center gap-2"><i data-lucide="table" class="w-4"></i> Fact Patients</div>
                    </div>

                    <div id="table-dim-diagnosis" class="schema-node bg-white p-4 rounded shadow-lg w-40 text-center top-64 right-32" data-role="table">
                        <div class="text-[10px] text-slate-400 font-bold uppercase mb-1">Table</div>
                        <div class="font-bold text-sm flex items-center justify-center gap-2"><i data-lucide="table" class="w-4"></i> Oncology Diagnosis</div>
                    </div>

                    <div id="table-hcp" class="schema-node bg-white p-4 rounded shadow-lg w-40 text-center top-[22rem] right-32" data-role="table">
                        <div class="text-[10px] text-slate-400 font-bold uppercase mb-1">Table</div>
                        <div class="font-bold text-sm flex items-center justify-center gap-2"><i data-lucide="table" class="w-4"></i> HCP Data</div>
                    </div>

                    <!-- Trial button  -->
                    <!-- <div id="table-hcp" class="schema-node bg-white p-4 rounded shadow-lg w-40 text-center top-[22rem] right-32" data-role="table"> --> -->
                    <!-- Info button -->
                        <!-- <button class="absolute top-2 right-2 text-red-600 hover:text-red-800" -->
                                <!-- title="More info"> -->
                            <!-- <i data-lucide="info" class="w-4 h-4"></i> -->
                        <!-- </button> -->
                        <!-- <div class="text-[10px] text-slate-400 font-bold uppercase mb-1">Table</div> -->
                        <!-- <div class="font-bold text-sm flex items-center justify-center gap-2"><i data-lucide="table" class="w-4"></i> Demographic info</div> -->
                    <!-- </div> -->
                    <!-- Trial button ends-->
                    <div id="table-hcp" class="schema-node table-danger" data-role="table">
                        <!-- Info button -->
                        <button class="info-btn group relative">
                            <i data-lucide="info" class="w-4 h-4"></i>
                        <span class="absolute top-[-32px] right-0 hidden group-hover:block
                                        bg-slate-900 text-white text-[10px] px-2 py-1 rounded">
                                Missing or inconsistent data types detected in the ZIP column.
                        </span>
                        </button>

                    <div class="text-[10px] font-bold uppercase mb-1">Table</div>
                    <div class="font-bold text-sm flex items-center justify-center gap-2">
                        <i data-lucide="table" class="w-4"></i> Demographic info
                    </div>
                    </div>
                </div>
                    <div class="flex justify-end pt-8 pb-4">
                        <button onclick="App.switchView('dashboard')" class="group flex items-center gap-2 text-sm font-semibold text-slate-400 hover:text-blue-600 transition-colors">
                            Next: Clinical Dashboard <i data-lucide="arrow-right" class="w-4 h-4 group-hover:translate-x-1 transition-transform"></i>
                        </button>
                    </div>
            </div>
                <div id="view-scenario-builder" class="hidden max-w-7xl mx-auto animate-fade-in">
                    <div class="grid grid-cols-1 lg:grid-cols-4 gap-8">
                        
                        <div class="lg:col-span-1 space-y-6">
                            <div class="bg-white p-6 rounded-xl border border-slate-200 shadow-sm">
                                <h3 class="text-sm font-bold text-slate-400 uppercase tracking-wider mb-4">Scenario Management</h3>
                                <div class="space-y-4">
                                    <div>
                                        <label class="block text-xs font-bold text-slate-500 mb-2">Select Scenario</label>
                                        <div class="flex gap-2">
                                            <select id="scenario-selector" class="w-full p-2.5 border rounded-lg bg-slate-50 text-sm focus:ring-2 focus:ring-blue-500 outline-none">
                                                </select>
                                        </div>
                                    </div>
                                    <button id="btn-new-scenario" type = button class="w-full py-2 px-4 bg-slate-100 hover:bg-slate-200 text-slate-700 font-bold rounded-lg text-xs flex items-center justify-center gap-2 transition-colors">
                                        <i data-lucide="plus" class="w-4"></i> Create New
                                    </button>
                                    <button id="btn-delete-scenario" class="w-full py-2 px-4 border border-rose-200 hover:bg-rose-50 text-rose-600 font-bold rounded-lg text-xs flex items-center justify-center gap-2 transition-colors">
                                        <i data-lucide="trash-2" class="w-4"></i> Delete Scenario
                                    </button>
                                </div>
                            </div>
                        </div>

                        <div class="lg:col-span-3">
                            <div class="bg-[#0f172a] rounded-xl shadow-lg p-8 text-white relative overflow-hidden">
                                <div class="absolute top-0 right-0 w-64 h-64 bg-blue-600 opacity-5 rounded-full blur-3xl transform translate-x-1/2 -translate-y-1/2"></div>

                                <div class="flex justify-between items-center mb-8 relative z-10">
                                    <h2 id="config-title" class="text-2xl font-bold">Configure: Conservative</h2>
                                    
                                    <div class="flex items-center gap-3 bg-slate-800/50 rounded-lg px-4 py-2 border border-slate-700/50 backdrop-blur-sm ml-auto mr-4">
                                        <label for="scenario-horizon" class="text-xs font-bold text-slate-400 uppercase tracking-wider">Horizon:</label>
                                        <select id="scenario-horizon" class="bg-transparent text-sm font-bold text-white outline-none cursor-pointer focus:ring-0 border-none p-0">
                                            <option value="5" class = "bg-[#1B2632] text-white">5 Years</option>
                                            <option value="7" class="bg-[#1B2632] text-white">7 Years</option>
                                            <option value="10" class="bg-[#1B2632] text-white" selected>10 Years</option>
                                        </select>
                                    </div>

                                    <button id="btn-save-scenario" class="bg-rose-700 hover:bg-rose-900 text-white px-6 py-2 rounded-lg font-bold text-sm flex items-center gap-2 transition-colors shadow-lg">
                                        <i data-lucide="save" class="w-4"></i> Save Configuration
                                    </button>
                                </div>
                                
                                <div class="relative z-10 mb-8 bg-slate-800/50 p-4 rounded-xl border border-slate-700/50">
                                    <label class="block text-xs font-bold text-red-400 uppercase tracking-wider mb-2">Select Forecasting Model</label>
                                    <select id="model-selector" class="w-full p-3 bg-slate-900 border border-slate-700 rounded-lg text-sm text-slate-200 focus:ring-2 focus:ring-blue-500 outline-none transition-all hover:border-slate-600">
                                        <option value="deterministic">Deterministic Throughput Models</option>
                                        <option value="littles-law">Littles Law Based Flow Models (Hospital Specific)</option>
                                        <option value="time-series">Time Series (SARIMA/ETS)</option>
                                        <option value="piecewise">Piecewise Linear Model (Trend + Seasonality + Changepoints)</option>
                                        <option value="ml-sim">Decision Tree/ Behavioural Simulation (Machine Learning)</option>
                                        <option value="stock-flow">Stock and Flow Model</option>
                                    </select>
                                </div>

                                <div class="grid grid-cols-1 md:grid-cols-3 gap-10 relative z-10">
                                    
                                    <div class="space-y-6">
                                        <h3 class="text-sm font-bold text-slate-400 uppercase tracking-wider border-b border-slate-700 pb-2">Growth Assumptions</h3>
                                        
                                        <div>
                                            <div class="flex justify-between text-xs mb-2">
                                                <label class="text-slate-300">Inpatient Growth (%/yr)</label>
                                                <span id="inpatientGrowth-val" class="font-mono text-rose-400 font-bold">2.00</span>
                                            </div>
                                            <input type="range" id="inpatientGrowth" min="0" max="15" step="0.1" class="w-full">
                                        </div>

                                        <div>
                                            <div class="flex justify-between text-xs mb-2">
                                                <label class="text-slate-300">Outpatient Growth (%/yr)</label>
                                                <span id="outpatientGrowth-val" class="font-mono text-rose-400 font-bold">3.00</span>
                                            </div>
                                            <input type="range" id="outpatientGrowth" min="0" max="20" step="0.1" class="w-full">
                                        </div>

                                        <div>
                                            <div class="flex justify-between text-xs mb-2">
                                                <label class="text-slate-300">New Patient Growth (%/yr)</label>
                                                <span id="newPatientGrowth-val" class="font-mono text-rose-400 font-bold">2.50</span>
                                            </div>
                                            <input type="range" id="newPatientGrowth" min="0" max="20" step="0.1" class="w-full">
                                        </div>
                                    </div>

                                    <div class="space-y-6">
                                        <h3 class="text-sm font-bold text-slate-400 uppercase tracking-wider border-b border-slate-700 pb-2">Market Assumptions</h3>
                                        
                                        <div>
                                            <div class="flex justify-between text-xs mb-2">
                                                <label class="text-slate-300">Market Share Target (%)</label>
                                                <span id="marketShare-val" class="font-mono text-rose-400 font-bold">35</span>
                                            </div>
                                            <input type="range" id="marketShare" min="0" max="100" step="1" class="w-full">
                                        </div>

                                        <div>
                                            <div class="flex justify-between text-xs mb-2">
                                                <label class="text-slate-300">Referral Network Growth (%)</label>
                                                <span id="referralGrowth-val" class="font-mono text-rose-400 font-bold">15</span>
                                            </div>
                                            <input type="range" id="referralGrowth" min="0" max="50" step="1" class="w-full">
                                        </div>

                                        <div class="pt-4">
                                            <h4 class="text-sm font-bold text-slate-400 uppercase tracking-wider mb-3">Program Expansion</h4>
                                            <select id="addPrograms" class="w-full p-2 bg-slate-800 border border-slate-700 rounded text-sm text-slate-300 focus:ring-1 focus:ring-rose-500 outline-none">
                                                <option value="">No Expansion</option>
                                                <option value="Cardiology">Cardiology</option>
                                                <option value="Neurology">Neurology</option>
                                                <option value="Orthopedics">Orthopedics</option>
                                            </select>
                                        </div>
                                    </div>

                                    <div class="space-y-6">
                                        <h3 class="text-sm font-bold text-slate-400 uppercase tracking-wider border-b border-slate-700 pb-2">Capacity Constraints</h3>
                                        
                                        <div class="flex items-center gap-3 mb-6">
                                            <input type="checkbox" id="applyCapacityLimits" class="w-5 h-5 rounded border-slate-600 bg-slate-800 text-rose-500 focus:ring-offset-slate-900">
                                            <label for="applyCapacityLimits" class="text-sm text-slate-300 select-none">Apply Capacity Limits</label>
                                        </div>

                                        <h3 class="text-sm font-bold text-slate-400 uppercase tracking-wider border-b border-slate-700 pb-2">Infrastructure</h3>
                                        
                                        <div>
                                            <label class="text-xs text-slate-300 block mb-2">Additional Beds</label>
                                            <div class="flex items-center bg-slate-800 rounded-lg border border-slate-700 p-1">
                                                <button class="p-2 hover:bg-slate-700 rounded text-slate-400 hover:text-white counter-btn" data-target="addBeds" data-action="decrement"><i data-lucide="minus" class="w-3"></i></button>
                                                <input type="number" id="addBeds" value="0" class="bg-transparent text-center w-full text-sm font-mono focus:outline-none" readonly>
                                                <button class="p-2 hover:bg-slate-700 rounded text-slate-400 hover:text-white counter-btn" data-target="addBeds" data-action="increment"><i data-lucide="plus" class="w-3"></i></button>
                                            </div>
                                        </div>

                                        <div>
                                            <label class="text-xs text-slate-300 block mb-2">Additional Infusion Chairs</label>
                                            <div class="flex items-center bg-slate-800 rounded-lg border border-slate-700 p-1">
                                                <button class="p-2 hover:bg-slate-700 rounded text-slate-400 hover:text-white counter-btn" data-target="addChairs" data-action="decrement"><i data-lucide="minus" class="w-3"></i></button>
                                                <input type="number" id="addChairs" value="0" class="bg-transparent text-center w-full text-sm font-mono focus:outline-none" readonly>
                                                <button class="p-2 hover:bg-slate-700 rounded text-slate-400 hover:text-white counter-btn" data-target="addChairs" data-action="increment"><i data-lucide="plus" class="w-3"></i></button>
                                            </div>
                                        </div>
                                    </div>

                                </div>
                            </div>
                        </div>
                    </div>
                    <div class="flex justify-end pt-8 pb-4">
                        <button onclick="App.switchView('forecasting')" class="group flex items-center gap-2 text-sm font-semibold text-slate-400 hover:text-blue-600 transition-colors">
                            Next: Forecasting <i data-lucide="arrow-right" class="w-4 h-4 group-hover:translate-x-1 transition-transform"></i>
                        </button>
                    </div>
                </div>

  <div id="view-forecasting" class="hidden h-[60vh] flex flex-col items-center justify-start animate-fade-in" >
  <div class="space-y-2 w-full max-w-7xl">

    <!-- Header / Controls -->
    <div class="bg-white p-6 rounded-xl border border-slate-200 shadow-sm">
      <div class="flex justify-between items-end mb-4">
        <h2 class="text-2xl font-bold text-slate-800">10-Year Forecast Generation</h2>
      </div>

      <div class="space-y-2">
        <label class="text-xs font-bold text-slate-500 uppercase tracking-wider">Select Scenarios to Forecast</label>

        <div class="relative group z-20">
          <div id="forecast-scenario-container" class="w-full min-h-[50px] p-2 bg-slate-50 border border-slate-200 rounded-lg flex flex-wrap items-center gap-2 cursor-text transition-all focus-within:ring-2 focus-within:ring-blue-500 focus-within:border-transparent relative">
            <input type="text" id="scenario-input" placeholder="Select scenarios..." class="bg-transparent border-none outline-none text-sm text-slate-700 placeholder:text-slate-400 flex-1 min-w-[150px] focus:ring-0">
            <i data-lucide="chevron-down" class="w-4 h-4 text-slate-400 absolute right-4 top-4 pointer-events-none"></i>
          </div>

          <div id="forecast-scenario-dropdown" class="absolute top-full left-0 right-0 mt-2 bg-white border border-slate-200 rounded-lg shadow-xl hidden max-h-60 overflow-y-auto">
          </div>
          <div class="grid grid-cols-2 gap-4 mb-6">
            <div>
                <label class="block text-sm font-medium text-slate-700 mb-1">Hospital</label>
                <select id="hospital-filter" class="w-full border border-slate-300 rounded-md p-2">
                <option value="all">All Hospitals</option>
                </select>
            </div>
            <div>
                <label class="block text-sm font-medium text-slate-700 mb-1">Service Line</label>
                <select id="service-line-filter" class="w-full border border-slate-300 rounded-md p-2">
                <option value="all">All Service Lines</option>
                </select>
            </div>
            </div>
          </div>
      </div>
    </div>

    <!-- Flowbite Tabs Header -->
    <div class="border-b border-gray-200">
      <ul class="flex flex-wrap -mb-px text-sm font-medium text-center text-gray-500" id="forecast-tabs" data-tabs-toggle="#forecast-tabs-content" role="tablist">
        <li class="me-2" role="presentation">
          <button class="inline-block p-4 border-b-2 rounded-t-lg" id="tab-volume-tab" data-tabs-target="#tab-volume" type="button" role="tab" aria-controls="tab-volume" aria-selected="true">
            Volume Projections
          </button>
        </li>
        <li class="me-2" role="presentation">
          <button class="inline-block p-4 border-b-2 rounded-t-lg" id="tab-growth-tab" data-tabs-target="#tab-growth" type="button" role="tab" aria-controls="tab-growth" aria-selected="false">
            Annual Growth
          </button>
        </li>
        <li role="presentation">
          <button class="inline-block p-4 border-b-2 rounded-t-lg" id="tab-capacity-tab" data-tabs-target="#tab-capacity" type="button" role="tab" aria-controls="tab-capacity" aria-selected="false">
            Capacity Analysis
          </button>
        </li>
      </ul>
    </div>

    <!-- Flowbite Tabs Content -->
    <div id="forecast-tabs-content" class="mt-6">
      
      <!-- Tab 1: Volume Projections -->
      <div class="hidden" id="tab-volume" role="tabpanel" aria-labelledby="tab-volume-tab">
        <div class="grid grid-cols-1 lg:grid-cols-2 gap-6">
          <!-- Inpatient Volume Forecast -->
          <div class="bg-white p-6 rounded-xl border border-slate-200 shadow-sm">
            <div class="mb-4">
              <h3 class="font-bold text-slate-800">Inpatient Volume Forecast</h3>
              <p class="text-xs text-slate-400">Comparison of selected scenario trajectories</p>
            </div>
            <div class="h-72 relative w-full">
              <canvas id="chart-forecast-inpatient"></canvas>
            </div>
          </div>

          <!-- Outpatient Volume Forecast -->
          <div class="bg-white p-6 rounded-xl border border-slate-200 shadow-sm">
            <div class="mb-4">
              <h3 class="font-bold text-slate-800">Outpatient Volume Forecast</h3>
              <p class="text-xs text-slate-400">Projected visit volumes by scenario</p>
            </div>
            <div class="h-72 relative w-full">
              <canvas id="chart-forecast-outpatient"></canvas>
            </div>
          </div>
        </div>
      </div>

      <!-- Tab 2: Annual Growth -->
      <div class="hidden" id="tab-growth" role="tabpanel" aria-labelledby="tab-growth-tab">
        <div class="grid grid-cols-1 gap-6">
          <!-- Annual Growth Comparison -->
          <div class="bg-white p-6 rounded-xl border border-slate-200 shadow-sm">
            <div class="mb-4">
              <h3 class="font-bold text-slate-800">Annual Growth Comparison</h3>
              <p class="text-xs text-slate-400">Year-over-year growth rates</p>
            </div>
            <div class="h-72 relative w-full">
              <canvas id="chart-forecast-growth"></canvas>
            </div>
          </div>
        </div>
      </div>

      <!-- Tab 3: Capacity Analysis -->
      <div class="hidden" id="tab-capacity" role="tabpanel" aria-labelledby="tab-capacity-tab">
        <div class="grid grid-cols-1 gap-6">
          <!-- Bed Capacity Gap Analysis -->
          <div class="bg-white p-6 rounded-xl border border-slate-200 shadow-sm">
            <div class="mb-4">
              <h3 class="font-bold text-slate-800">Bed Capacity Gap Analysis</h3>
              <p class="text-xs text-slate-400">Projected demand vs. current physical capacity</p>
            </div>
            <div class="h-72 relative w-full">
              <canvas id="chart-forecast-gap"></canvas>
            </div>
          </div>
        </div>
      </div>

    </div>
    <!-- /Tabs Content -->

  </div>
    <div class="flex justify-end pt-8 pb-4 w-full">
        <button onclick="App.switchView('scenario-comparison')" class="group flex items-center gap-2 text-sm font-semibold text-slate-400 hover:text-blue-600 transition-colors">
            Next: Scenario Comparison <i data-lucide="arrow-right" class="w-4 h-4 group-hover:translate-x-1 transition-transform"></i>
        </button>
    </div>
</div>

                <div id="view-scenario-comparison" class="hidden max-w-7xl mx-auto animate-fade-in pb-10">
    
                    <div class="flex flex-col md:flex-row justify-between items-end mb-8 gap-4">
                        <div>
                            <h2 class="text-2xl font-bold text-slate-900">Side-by-Side Scenario Analysis</h2>
                            <p class="text-slate-500 text-sm mt-1">Compare long-term impacts of strategic decisions.</p>
                        </div>
                        
                        <div class="flex items-center gap-4 bg-white p-3 rounded-xl border border-slate-200 shadow-sm">
                            <div class="flex flex-col">
                                <label class="text-[10px] font-bold text-slate-400 uppercase tracking-wider mb-1">Scenario A (Baseline)</label>
                                <select id="compare-select-a" class="bg-slate-50 border border-slate-200 text-slate-800 text-sm rounded-lg focus:ring-blue-500 focus:border-blue-500 block w-48 p-2 outline-none font-medium">
                                    </select>
                            </div>
                            
                            <div class="h-8 w-px bg-slate-200"></div>

                            <div class="flex flex-col">
                                <label class="text-[10px] font-bold text-slate-400 uppercase tracking-wider mb-1">Scenario B (Target)</label>
                                <select id="compare-select-b" class="bg-slate-50 border border-slate-200 text-slate-800 text-sm rounded-lg focus:ring-blue-500 focus:border-blue-500 block w-48 p-2 outline-none font-medium">
                                    </select>
                            </div>
                        </div>
                    </div>

                    <div class="grid grid-cols-1 md:grid-cols-3 gap-6 mb-8">
                        
                        <div class="bg-white p-6 rounded-xl border border-slate-200 shadow-sm relative overflow-hidden group">
                            <div class="absolute top-0 left-0 w-1 h-full bg-slate-400"></div>
                            <h3 class="text-sm font-bold text-slate-500 uppercase tracking-wider mb-4" id="label-scenario-a">Scenario A</h3>
                            
                            <div class="mb-6">
                                <p class="text-xs text-slate-400 mb-1">Inpatient Volume (10y)</p>
                                <p class="text-3xl font-bold text-slate-800" id="val-a-inpatient">--</p>
                            </div>
                            <div>
                                <p class="text-xs text-slate-400 mb-1">Outpatient Volume (10y)</p>
                                <p class="text-3xl font-bold text-slate-800" id="val-a-outpatient">--</p>
                            </div>
                        </div>

                        <div class="bg-white p-6 rounded-xl border border-slate-200 shadow-sm relative overflow-hidden group">
                            <div class="absolute top-0 left-0 w-1 h-full bg-blue-600"></div>
                            <h3 class="text-sm font-bold text-slate-500 uppercase tracking-wider mb-4" id="label-scenario-b">Scenario B</h3>
                            
                            <div class="mb-6">
                                <p class="text-xs text-slate-400 mb-1">Inpatient Volume (10y)</p>
                                <p class="text-3xl font-bold text-slate-800" id="val-b-inpatient">--</p>
                            </div>
                            <div>
                                <p class="text-xs text-slate-400 mb-1">Outpatient Volume (10y)</p>
                                <p class="text-3xl font-bold text-slate-800" id="val-b-outpatient">--</p>
                            </div>
                        </div>

                        <div class="bg-slate-900 p-6 rounded-xl shadow-lg text-white relative overflow-hidden">
                            <div class="absolute -right-6 -top-6 w-32 h-32 bg-white opacity-5 rounded-full blur-2xl"></div>
                            <h3 class="text-sm font-bold text-slate-400 uppercase tracking-wider mb-4 flex items-center gap-2">
                                Variance <i data-lucide="arrow-right-left" class="w-3 h-3"></i>
                            </h3>

                            <div class="mb-6">
                                <div class="flex justify-between items-end">
                                    <div>
                                        <p class="text-xs text-slate-400 mb-1">Inpatient </p>
                                        <p class="text-3xl font-bold" id="diff-inpatient">--</p>
                                    </div>
                                    <span class="text-xs font-bold px-2 py-1 rounded bg-slate-800 mb-1" id="pct-inpatient">--%</span>
                                </div>
                            </div>
                            <div>
                                <div class="flex justify-between items-end">
                                    <div>
                                        <p class="text-xs text-slate-400 mb-1">Outpatient </p>
                                        <p class="text-3xl font-bold" id="diff-outpatient">--</p>
                                    </div>
                                    <span class="text-xs font-bold px-2 py-1 rounded bg-slate-800 mb-1" id="pct-outpatient">--%</span>
                                </div>
                            </div>
                        </div>
                    </div>

                    <div class="grid grid-cols-1 lg:grid-cols-3 gap-8">
                        
                        <div class="lg:col-span-2 bg-white rounded-xl border border-slate-200 shadow-sm overflow-hidden">
                            <div class="px-6 py-4 border-b border-slate-100 bg-slate-50/50">
                                <h3 class="font-bold text-slate-800">Parameter Configuration Comparison</h3>
                            </div>
                            <table class="w-full text-sm text-left">
                                <thead class="text-xs text-slate-400 uppercase bg-slate-50 border-b border-slate-100">
                                    <tr>
                                        <th class="px-6 py-3 font-semibold">Key Parameters</th>
                                        <th class="px-6 py-3 font-semibold text-slate-600" id="table-head-a">Scenario A</th>
                                        <th class="px-6 py-3 font-semibold text-blue-600" id="table-head-b">Scenario B</th>
                                    </tr>
                                </thead>
                                <tbody class="divide-y divide-slate-100" id="comparison-table-body">
                                    </tbody>
                            </table>
                        </div>

                        <div class="bg-gradient-to-br from-slate-900 to-slate-800 rounded-xl shadow-lg p-6 text-white">
                            <div class="flex items-center gap-3 mb-6">
                                <div class="w-10 h-10 rounded-lg bg-white/10 flex items-center justify-center">
                                    <i data-lucide="lightbulb" class="w-5 h-5 text-yellow-400"></i>
                                </div>
                                <div>
                                    <h3 class="font-bold">Strategic Insights</h3>
                                    <p class="text-xs text-slate-400">AI-Generated Key Findings</p>
                                </div>
                            </div>

                            <ul class="space-y-4">
                                <li class="flex gap-3 text-sm text-slate-300">
                                    <i data-lucide="check-circle-2" class="w-5 h-5 text-emerald-400 shrink-0"></i>
                                    <span>The gap between scenarios widens significantly after year 5.</span>
                                </li>
                                <li class="flex gap-3 text-sm text-slate-300">
                                    <i data-lucide="check-circle-2" class="w-5 h-5 text-emerald-400 shrink-0"></i>
                                    <span id="insight-dynamic-1">Base Case projects volume increase by 2034.</span>
                                </li>
                                <li class="flex gap-3 text-sm text-slate-300">
                                    <i data-lucide="check-circle-2" class="w-5 h-5 text-emerald-400 shrink-0"></i>
                                    <span>Infrastructure investments should be phased based on chosen strategy.</span>
                                </li>
                                <li class="flex gap-3 text-sm text-slate-300">
                                    <i data-lucide="check-circle-2" class="w-5 h-5 text-emerald-400 shrink-0"></i>
                                    <span>Both scenarios indicate need for capacity expansion by 2027.</span>
                                </li>
                            </ul>

                            <button class="w-full mt-8 py-3 bg-blue-600 hover:bg-blue-500 rounded-lg font-bold text-sm transition-colors" onclick="App.switchView('Export-&-Reports')">
                                Generate Full Report
                            </button>
                        </div>

                    </div>
                    <!-- <div class="flex justify-end pt-8 pb-4">
                        <button onclick="App.switchView('Export-&-Reports')" class="group flex items-center gap-2 text-sm font-semibold text-slate-400 hover:text-blue-600 transition-colors">
                            Next: Export & Reports <i data-lucide="arrow-right" class="w-4 h-4 group-hover:translate-x-1 transition-transform"></i>
                        </button>
                    </div> -->
                </div>

                <div id="view-Export-&-Reports" class="hidden max-w-7xl mx-auto animate-fade-in pb-10">
                    <div class="flex flex-col md:flex-row justify-between items-end mb-8 gap-4">
                        <div>
                            <h2 class="text-2xl font-bold text-slate-900">Export & Strategic Reporting</h2>
                            <p class="text-slate-500 text-sm mt-1">Generate forecast datasets and executive summaries.</p>
                        </div>
                    </div>

                    <div class="grid grid-cols-1 xl:grid-cols-2 gap-8">
                        
                        <div class="space-y-6">
                            <div class="bg-white p-6 rounded-xl border border-slate-200 shadow-sm">
                                <h3 class="font-bold text-slate-800 mb-4 flex items-center gap-2">
                                    <i data-lucide="database" class="w-5 h-5 text-blue-600"></i> Raw Data Export
                                </h3>
                                
                                <div class="space-y-6">
                                    <div>
                                        <label class="text-xs font-bold text-slate-500 uppercase tracking-wider block mb-2">Export Format</label>
                                        <div class="flex gap-3">
                                            <button class="export-fmt-btn flex-1 py-3 px-4 rounded-lg border border-slate-200 hover:border-blue-500 hover:bg-blue-50 text-slate-600 font-bold text-sm transition-all active-format" data-format="csv">
                                                CSV
                                            </button>
                                            <button class="export-fmt-btn flex-1 py-3 px-4 rounded-lg border border-slate-200 hover:border-green-500 hover:bg-green-50 text-slate-600 font-bold text-sm transition-all" data-format="xlsx">
                                                Excel (.xlsx)
                                            </button>
                                            <button class="export-fmt-btn flex-1 py-3 px-4 rounded-lg border border-slate-200 hover:border-orange-500 hover:bg-orange-50 text-slate-600 font-bold text-sm transition-all" data-format="json">
                                                JSON
                                            </button>
                                        </div>
                                    </div>

                                    <div class="flex items-center gap-3 p-3 bg-slate-50 rounded-lg border border-slate-100">
                                        <input type="checkbox" id="export-include-history" class="w-5 h-5 rounded border-slate-300 text-blue-600 focus:ring-blue-500" checked>
                                        <div class="flex-1">
                                            <label for="export-include-history" class="text-sm font-bold text-slate-700 block">Include Historical Data</label>
                                            <p class="text-xs text-slate-400">Append actuals (2020-2025) to the forecast dataset.</p>
                                        </div>
                                    </div>

                                    <button id="btn-download-data" class="w-full py-3 bg-slate-800 hover:bg-slate-700 text-white font-bold rounded-lg flex items-center justify-center gap-2 transition-colors">
                                        <i data-lucide="download" class="w-4 h-4"></i> Download Dataset
                                    </button>
                                </div>
                            </div>

                            <div class="bg-white rounded-xl border border-slate-200 shadow-sm overflow-hidden">
                                <div class="px-6 py-4 border-b border-slate-100 bg-slate-50/50 flex justify-between items-center">
                                    <h3 class="font-bold text-slate-800 text-sm">Export Preview</h3>
                                    <span class="text-xs font-mono text-slate-400">Top 5 Rows</span>
                                </div>
                                <div class="overflow-x-auto">
                                    <table class="w-full text-sm text-left">
                                        <thead class="text-xs text-slate-400 uppercase bg-slate-50 border-b border-slate-100">
                                            <tr>
                                                <th class="px-4 py-3 font-semibold">Year</th>
                                                <th class="px-4 py-3 font-semibold">Scenario</th>
                                                <th class="px-4 py-3 font-semibold">Inpatient</th>
                                                <th class="px-4 py-3 font-semibold">Outpatient</th>
                                            </tr>
                                        </thead>
                                        <tbody class="divide-y divide-slate-100 text-slate-600" id="export-preview-body">
                                            </tbody>
                                    </table>
                                </div>
                            </div>
                        </div>

                        <div class="space-y-6">
                            <div class="bg-white p-6 rounded-xl border border-slate-200 shadow-sm">
                                <div class="flex justify-between items-start mb-6">
                                    <h3 class="font-bold text-slate-800 flex items-center gap-2">
                                        <i data-lucide="file-text" class="w-5 h-5 text-rose-600"></i> Executive Report
                                    </h3>
                                    <select id="report-scenario-select" class="bg-slate-50 border border-slate-200 text-slate-800 text-xs font-bold rounded-lg focus:ring-rose-500 focus:border-rose-500 block p-2 outline-none">
                                        </select>
                                </div>

                                <div class="bg-slate-100 p-4 rounded-xl border border-slate-200 h-[600px] overflow-y-auto custom-scrollbar">
                                    
                                    <div id="report-paper" class="bg-white shadow-lg mx-auto w-full max-w-[500px] min-h-[700px] p-8 text-slate-800 relative">
                                        <div class="border-b-2 border-slate-800 pb-4 mb-8">
                                            <h1 class="text-xl font-bold uppercase tracking-tight text-slate-900">Executive Summary</h1>
                                            <h2 class="text-lg text-rose-600 font-serif italic mt-1" id="rpt-scenario-name">Conservative Scenario</h2>
                                            <p class="text-[10px] text-slate-400 mt-2 uppercase tracking-widest">10-Year Strategic Forecast  Generated <span id="rpt-date">--</span></p>
                                        </div>

                                        <div class="grid grid-cols-2 gap-4 mb-8">
                                            <div class="bg-slate-50 p-3 border border-slate-100">
                                                <p class="text-[9px] text-slate-500 uppercase font-bold">10-Year Inpatient Growth</p>
                                                <p class="text-2xl font-bold text-slate-800 mt-1" id="rpt-inpatient-growth">--%</p>
                                                <p class="text-[10px] text-emerald-600 font-bold" id="rpt-inpatient-delta">-- patients</p>
                                            </div>
                                            <div class="bg-slate-50 p-3 border border-slate-100">
                                                <p class="text-[9px] text-slate-500 uppercase font-bold">10-Year Outpatient Growth</p>
                                                <p class="text-2xl font-bold text-slate-800 mt-1" id="rpt-outpatient-growth">--%</p>
                                                <p class="text-[10px] text-emerald-600 font-bold" id="rpt-outpatient-delta">-- patients</p>
                                            </div>
                                        </div>

                                        <div class="prose prose-sm prose-slate max-w-none">
                                            <h4 class="text-xs font-bold uppercase text-slate-400 mb-2 border-b">Key Findings</h4>
                                            <p class="text-xs leading-relaxed mb-4">
                                                Under the <strong id="rpt-text-scenario">Conservative</strong> scenario, MD Anderson Cancer Network is projected to experience significant growth over the next decade. By 2034:
                                            </p>
                                            <ul class="text-xs list-disc pl-4 space-y-1 mb-6 text-slate-600">
                                                <li>Inpatient volume is expected to reach <strong id="rpt-text-inpatient-vol">--</strong> admissions annually.</li>
                                                <li>Outpatient volume will grow to <strong id="rpt-text-outpatient-vol">--</strong> visits per year.</li>
                                                <li>This translates to an additional <strong id="rpt-text-total-delta">--</strong> patient encounters annually.</li>
                                            </ul>

                                            <h4 class="text-xs font-bold uppercase text-slate-400 mb-2 border-b">Strategic Implications</h4>
                                            
                                            <p class="text-[10px] font-bold mt-3 mb-1">Infrastructure Requirements:</p>
                                            <ul class="text-[10px] list-disc pl-4 space-y-1 text-slate-600">
                                                <li>Current capacity will likely be insufficient by 2027-2028.</li>
                                                <li>Recommend planning for <strong>300-500</strong> additional beds.</li>
                                                <li>Infusion chair capacity should increase by 40-60 units.</li>
                                            </ul>

                                            <p class="text-[10px] font-bold mt-3 mb-1">Financial Impact:</p>
                                            <ul class="text-[10px] list-disc pl-4 space-y-1 text-slate-600">
                                                <li>Capital investment required: <strong>$150M - $250M</strong> (est).</li>
                                                <li>Revenue growth potential: <strong>$400M - $600M</strong> annually.</li>
                                            </ul>
                                            
                                            <div class="mt-8 pt-4 border-t border-slate-100 text-center">
                                                <p class="text-[9px] text-slate-300 italic">Confidential - Internal Use Only</p>
                                            </div>
                                        </div>
                                    </div>
                                </div>

                                <div class="mt-4 flex gap-3">
                                    <button class="flex-1 py-2 border border-slate-200 hover:bg-slate-50 text-slate-700 font-bold rounded text-xs flex items-center justify-center gap-2">
                                        <i data-lucide="file" class="w-3"></i> PDF
                                    </button>
                                    <button class="flex-1 py-2 border border-slate-200 hover:bg-slate-50 text-slate-700 font-bold rounded text-xs flex items-center justify-center gap-2">
                                        <i data-lucide="file-type-2" class="w-3"></i> Word
                                    </button>
                                    <button class="flex-1 py-2 border border-slate-200 hover:bg-slate-50 text-slate-700 font-bold rounded text-xs flex items-center justify-center gap-2">
                                        <i data-lucide="code" class="w-3"></i> HTML
                                    </button>
                                </div>

                            </div>
                        </div>
                    </div>
                </div>

            </div>
        </main>
    </div>

    <div id="model-training-overlay" class="fixed inset-0 z-[70] bg-slate-900/80 backdrop-blur-sm hidden flex flex-col items-center justify-center transition-opacity duration-300 opacity-0">
        <div class="bg-white p-8 rounded-2xl shadow-2xl flex flex-col items-center space-y-5 max-w-sm w-full text-center border border-white/10">
            <div class="relative">
                <div class="w-20 h-20 border-[5px] border-blue-100 border-t-blue-600 rounded-full animate-spin"></div>
                <div class="absolute inset-0 flex items-center justify-center text-blue-600">
                    <i data-lucide="cpu" class="w-8 h-8"></i>
                </div>
            </div>
            <div>
                <h3 class="text-xl font-bold text-slate-800">Training Model...</h3>
                <p class="text-sm text-slate-500 mt-2">Optimizing parameters & processing historical data</p>
            </div>
            <div class="w-full bg-slate-100 rounded-full h-1.5 mt-2 overflow-hidden relative">
                <div class="absolute h-full bg-blue-600 w-1/2 animate-progress-indeterminate rounded-full"></div>
            </div>
        </div>
    </div>


    <div id="dataset-info-modal" class="fixed inset-0 z-[80] bg-slate-900/50 backdrop-blur-sm hidden items-center justify-center opacity-0 transition-opacity duration-300">
        <div class="bg-white rounded-2xl shadow-2xl w-full max-w-2xl overflow-hidden transform scale-95 transition-transform duration-300">
            <div class="bg-slate-50 px-6 py-4 border-b border-slate-100 flex justify-between items-center">
                <h3 class="font-bold text-slate-800 flex items-center gap-2">
                    <i data-lucide="database" class="w-5 h-5 text-blue-600"></i> Dataset Schema
                </h3>
                <button class="text-slate-400 hover:text-slate-600 transition-colors modal-close-btn">
                    <i data-lucide="x" class="w-5 h-5"></i>
                </button>
            </div>
            <div class="p-6">
                <p class="text-sm text-slate-500 mb-6">Supported formats: <strong class="text-slate-700">.xlsx, .csv, .json</strong>. Ensure your upload matches the schema below.</p>
                <div class="overflow-hidden rounded-lg border border-slate-200">
                    <table class="w-full text-sm text-left">
                        <thead class="bg-slate-50 text-xs font-bold text-slate-500 uppercase">
                            <tr>
                                <th class="px-4 py-3">Column Name</th>
                                <th class="px-4 py-3">Data Type</th>
                                <th class="px-4 py-3">Description</th>
                            </tr>
                        </thead>
                        <tbody id="dataset-info-body" class="divide-y divide-slate-100 bg-white">
                            </tbody>
                    </table>
                </div>
            </div>
            <div class="px-6 py-4 bg-slate-50 border-t border-slate-100 flex justify-end">
                <button class="px-4 py-2 bg-slate-800 hover:bg-slate-700 text-white text-sm font-bold rounded-lg transition-colors modal-close-btn">Close</button>
            </div>
        </div>
    </div>

    <div id="new-scenario-modal" class="fixed inset-0 z-[80] bg-slate-900/60 backdrop-blur-sm hidden flex items-center justify-center opacity-0 transition-opacity duration-300">
        <div class="bg-white rounded-xl shadow-2xl w-full max-w-md p-6 transform scale-95 transition-transform duration-300">
            <h3 class="text-xl font-bold text-slate-800 mb-2">Create New Scenario</h3>
            <p class="text-sm text-slate-500 mb-6">Define a unique name for your strategic forecast scenario.</p>
            
            <div class="space-y-4">
                <div>
                    <label class="block text-xs font-bold text-slate-500 uppercase tracking-wider mb-2">Scenario Name</label>
                    <input type="text" id="new-scenario-name" placeholder="e.g., Optimistic Growth 2026" class="w-full p-3 border border-slate-200 rounded-lg focus:ring-2 focus:ring-blue-500 outline-none text-slate-800 font-medium">
                    <p id="new-scenario-error" class="text-xs text-rose-600 mt-2 hidden font-bold flex items-center gap-1"> <i data-lucide="alert-circle" class="w-3"></i> <span>Error message</span> </p>
                </div>
                
                <div class="flex gap-3 mt-6">
                    <button id="btn-cancel-scenario" class="flex-1 py-3 border border-slate-200 text-slate-600 font-bold rounded-lg hover:bg-slate-50 transition-colors">Cancel</button>
                    <button id="btn-confirm-scenario" class="flex-1 py-3 bg-blue-600 text-white font-bold rounded-lg hover:bg-blue-700 transition-colors shadow-lg shadow-blue-200">Create Scenario</button>
                </div>
            </div>
        </div>
    </div>

    <div id="toast-container"></div>

    <script src="src/dataService.js"></script>
    <script src="src/charts.js"></script>
    <script src="src/schema.js"></script>
    <script src="src/wizard.js"></script>
    <script src="src/scenario.js"></script>
    <script src="src/forecast.js"></script>
    <script src="src/comparison.js"></script>
    <script src="src/reports.js"></script>
    <script src="src/cancerDashboard.js"></script>
    <script src="src/geographyDashboard.js"></script>
    <script src="src/app.js" defer></script>

</body>
</html>